<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UUcats Repository</title>
    <link rel="preload" href="https://storage.googleapis.com/uucats-repository-images/hero/hero-image-1746967832302.webp" as="image">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Noto Sans KR', sans-serif;
        }
        
        body {
            background-color: #f5f5f5;
            color: #333;
        }
        
        header {
            background-color: #fff;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            padding: 20px 0;
            position: sticky;
            top: 0;
            z-index: 100;
        }
        
        .container {
            width: 90%;
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .logo {
            font-size: 24px;
            font-weight: bold;
            color: #333;
            text-decoration: none;
        }
        
        .nav-links {
            display: flex;
            gap: 20px;
        }
        
        .nav-links a {
            text-decoration: none;
            color: #333;
            transition: color 0.3s;
        }
        
        .nav-links a:hover {
            color: #4285f4;
        }
        
        .social-link {
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .social-link svg {
            width: 20px;
            height: 20px;
        }

        /* === íˆì–´ë¡œ ì„¹ì…˜ ìŠ¤íƒ€ì¼ì´ë‹¤ëƒ¥! === */
        .hero-section {
            width: 100%;
            height: 800px; /* ì¡°ê¸ˆ ë” ë†’ê²Œ ì¡°ì •í–ˆë‹¤ì˜¹ */
            overflow: hidden;
            position: relative; /* ë¬¸êµ¬ ìœ„ì¹˜ ì¡ê¸° í¸í•˜ê²Œ! */
            text-align: center;
            background-color: #e0e0e0; /* ê¸°ë³¸ ë°°ê²½ìƒ‰ */
            display: flex; /* ë¬¸êµ¬ ì¤‘ì•™ ì •ë ¬ì„ ìœ„í•´ ì¶”ê°€í–ˆë‹¤ì˜¹ */
            flex-direction: column; /* ë¬¸êµ¬ë¥¼ ì´ë¯¸ì§€ ì•„ë˜ë¡œ! */
            justify-content: flex-end; /* ë¬¸êµ¬ë¥¼ ì•„ë˜ìª½ì— ë¶™ì¸ë‹¤ì˜¹ */
            align-items: center; /* ê°€ë¡œ ì¤‘ì•™ ì •ë ¬ */
        }

        #hero-image-display {
            width: 100%;
            height: 100%; /* ë¶€ëª¨ ë†’ì´ì— ë§ì¶¤ */
            object-fit: cover; /* ì´ë¯¸ì§€ê°€ ë¹„ìœ¨ ìœ ì§€í•˜ë©° ê½‰ ì°¨ê²Œ! */
            position: absolute; /* ë¬¸êµ¬ë‘ ê²¹ì¹  ìˆ˜ ìˆê²Œ! */
            top: 0;
            left: 0;
            z-index: 1; /* ë¬¸êµ¬ë³´ë‹¤ ë’¤ì— ìˆë„ë¡! */
        }

        .hero-text-container {
            position: relative; /* z-index ì ìš©ì„ ìœ„í•´ */
            z-index: 2; /* ì´ë¯¸ì§€ë³´ë‹¤ ìœ„ì— ìˆë„ë¡! */
            color: white;
            padding: 20px;
            background-color: rgba(0, 0, 0, 0.5); /* ê°€ë…ì„±ì„ ìœ„í•œ ë°˜íˆ¬ëª… ë°°ê²½ */
            width: 100%; /* ê°€ë¡œ ê½‰ ì°¨ê²Œ */
            text-align: center;
            border-bottom-left-radius: 8px; /* ì‚´ì§ ë‘¥ê¸€ê²Œ~ */
            border-bottom-right-radius: 8px;
        }

        #hero-title-display {
            font-size: 2.5em; /* í° ì œëª©! */
            font-weight: bold;
            margin-bottom: 5px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.7); /* ê¸€ì ê·¸ë¦¼ì! */
        }

        #hero-subtitle-display {
            font-size: 1.2em; /* ì‘ì€ ë¶€ì œëª©! */
            text-shadow: 1px 1px 3px rgba(0,0,0,0.7);
        }
        /* === íˆì–´ë¡œ ì„¹ì…˜ ìŠ¤íƒ€ì¼ ëì´ë‹¤ëƒ¥! === */
        
        main {
            padding: 40px 0;
        }
        
        .gallery {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }
        
        .gallery-item {
            position: relative;
            overflow: hidden;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            background-color: #fff;
            cursor: pointer;
        }
        
        .gallery-item img {
            width: 100%;
            height: 250px;
            object-fit: cover;
            transition: transform 0.3s;
        }
        
        .gallery-item:hover img {
            transform: scale(1.05);
        }
        
        .photo-title {
            padding: 10px;
            text-align: center;
            font-weight: 500;
            color: #333;
            position: relative;
            z-index: 10;
            background-color: #fff;
        }
        
        .modal {
            display: none;
            position: fixed;
            z-index: 200;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.9);
            justify-content: center;
            align-items: center;
            flex-direction: column;
            padding-bottom: 50px;
        }
        
        .modal-content {
            max-width: 85%;
            max-height: 75%;
            margin-bottom: 15px;
        }
        
        .close {
            position: absolute;
            top: 20px;
            right: 30px;
            color: #fff;
            font-size: 40px;
            font-weight: bold;
            cursor: pointer;
        }
        
        .modal-title {
            color: #fff;
            text-align: center;
            font-size: 18px;
            width: 100%;
            padding: 10px 20px;
            background-color: rgba(0, 0, 0, 0.5);
            border-radius: 5px;
            max-width: 85%;
        }
        
        .nav-btn {
            position: absolute;
            top: 40%;
            transform: translateY(-50%);
            color: white;
            font-size: 30px;
            font-weight: bold;
            cursor: pointer;
            background-color: rgba(0, 0, 0, 0.5);
            width: 50px;
            height: 50px;
            line-height: 50px;
            text-align: center;
            border-radius: 50%;
            transition: background-color 0.3s;
            z-index: 20;
        }
        
        .nav-btn:hover {
            background-color: rgba(0, 0, 0, 0.8);
        }
        
        .prev-btn {
            left: 20px;
        }
        
        .next-btn {
            right: 20px;
        }
        
        /* ë¡œê·¸ì¸ ëª¨ë‹¬ */
        .login-modal {
            display: none;
            position: fixed;
            z-index: 200;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
            justify-content: center;
            align-items: center;
        }
        
        .login-form {
            background-color: #fff;
            padding: 30px;
            border-radius: 8px;
            width: 350px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }
        
        .login-form h2 {
            margin-bottom: 20px;
            text-align: center;
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 500;
        }
        
        .form-group input {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        
        .btn {
            display: inline-block;
            padding: 10px 20px;
            background-color: #4285f4;
            color: #fff;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            transition: background-color 0.3s;
            margin-top: 5px; /* ë²„íŠ¼ ê°„ê²© ì‚´ì§! */
        }
        
        .btn:hover {
            background-color: #3367d6;
        }
        
        .btn-block {
            display: block;
            width: 100%;
        }

        .btn-danger { /* ì‚­ì œ ë²„íŠ¼ìš© ë¹¨ê°„ìƒ‰! */
            background-color: #ff4444;
        }
        .btn-danger:hover {
            background-color: #cc0000;
        }
        
        /* ê´€ë¦¬ì íŒ¨ë„ */
        .admin-panel {
            display: none;
            background-color: #fff;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 30px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        
        .admin-panel h2, .admin-panel h3 { /* h3ë„ ì¶”ê°€í–ˆì˜¹ */
            margin-bottom: 15px; /* ê°„ê²© ì‚´ì§ ì¤„ì˜€ì˜¹ */
            margin-top: 20px; /* ì„¹ì…˜ë³„ ê°„ê²© */
        }
        .admin-panel h2:first-child {
            margin-top: 0; /* ì²«ë²ˆì§¸ h2ëŠ” ìœ„ìª½ ê°„ê²© ì—†ìŒ! */
        }
        
        .upload-form, .hero-text-form, .category-form { /* í¼ ìŠ¤íƒ€ì¼ í†µì¼ì´ë‹¤ëƒ¥ */
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
            align-items: flex-end; /* ë²„íŠ¼ì´ë‘ ì¸í’‹ ë†’ì´ ë§ì¶”ë ¤ê³ ! */
        }
        
        .file-input, .text-input { /* ì¸í’‹ ìŠ¤íƒ€ì¼ í†µì¼! */
            flex: 1;
            min-width: 200px;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        
        .gallery-admin {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
        }
        
        .gallery-admin-item {
            position: relative;
        }
        
        .gallery-admin-item img {
            width: 100%;
            height: 150px;
            object-fit: cover;
            border-radius: 4px;
        }
        
        .delete-btn {
            position: absolute;
            top: 5px;
            right: 5px;
            background-color: #ff4444;
            color: white;
            border: none;
            border-radius: 50%;
            width: 25px;
            height: 25px;
            line-height: 25px;
            text-align: center;
            cursor: pointer;
        }
        
        .logout-btn {
            background-color: #f44336;
            margin-top: 15px;
        }
        
        .logout-btn:hover {
            background-color: #d32f2f;
        }

        .category-list { /* ì¹´í…Œê³ ë¦¬ ëª©ë¡ ìŠ¤íƒ€ì¼ */
            list-style: none;
            padding: 0;
            margin-bottom: 15px;
        }
        .category-list li {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px;
            border: 1px solid #eee;
            margin-bottom: 5px;
            border-radius: 4px;
        }
        .category-list li button {
            padding: 3px 8px;
            font-size: 12px;
        }
        
        @media (max-width: 768px) {
            .gallery {
                grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            }
            
            .header-content {
                flex-direction: column;
                gap: 15px;
            }
            
            .nav-links {
                flex-wrap: wrap;
                justify-content: center;
            }
            
            .category-dropdown {
                font-size: 14px;
                padding: 10px 15px;
            }

            #hero-title-display {
                font-size: 1.8em;
            }
            #hero-subtitle-display {
                font-size: 1em;
            }
            .hero-text-container {
                padding: 15px;
            }
        }
    </style>
</head>
<body>
    <header>
        <div class="container header-content">
            <a href="#" class="logo">UUcats Repository</a>
            <div class="nav-links">
                <a href="#" class="social-link" id="twitter-link">
                    <svg viewBox="0 0 24 24">
                        <path fill="currentColor" d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/>
                    </svg>
                    (íŠ¸ìœ„í„°)
                </a>
                <a href="#" id="login-button">ê´€ë¦¬ì</a>
            </div>
        </div>
    </header>

    <section class="hero-section">
        <img id="hero-image-display" src="https://storage.googleapis.com/uucats-repository-images/hero/hero-image-1746967832302.webp" alt="UUcats Repositoryì˜ ë©‹ì§€ê³  ì„ ëª…í•œ ëŒ€í‘œ ê³ ì–‘ì´ íˆì–´ë¡œ ì´ë¯¸ì§€ë‹¤ì˜¹!">
        <div class="hero-text-container">
            <h1 id="hero-title-display">Pulchritudinem per imagines trado</h1>
            <p id="hero-subtitle-display">@uu_cats</p>
        </div>
    </section>
        </div>
    </section>
    <main class="container">
        <div class="admin-panel" id="admin-panel">
            <h2>ê´€ë¦¬ì íŒ¨ë„</h2>

            <h3>íˆì–´ë¡œ ì´ë¯¸ì§€ ê´€ë¦¬</h3>
            <div class="upload-form">
                <input type="file" class="file-input" id="hero-image-upload-input" accept="image/*">
                <button class="btn" id="hero-image-upload-btn">íˆì–´ë¡œ ì´ë¯¸ì§€ ì—…ë¡œë“œ</button>
            </div>
            <div id="current-hero-image-admin" style="margin-top:10px; margin-bottom: 20px;">
                <p><strong>í˜„ì¬ íˆì–´ë¡œ ì´ë¯¸ì§€:</strong></p>
                <img id="admin-hero-preview" src="/api/placeholder/400/150" alt="í˜„ì¬ íˆì–´ë¡œ ì´ë¯¸ì§€ ë¯¸ë¦¬ë³´ê¸°" style="max-width: 400px; max-height: 150px; object-fit: cover; border-radius: 4px; margin-top: 5px;">
                <button class="btn btn-danger" id="hero-image-delete-btn" style="display: block; margin-top: 10px;">íˆì–´ë¡œ ì´ë¯¸ì§€ ì‚­ì œ</button>
            </div>
            <h3>íˆì–´ë¡œ ë¬¸êµ¬ ê´€ë¦¬</h3>
            <div class="hero-text-form">
                <input type="text" id="hero-title-input" class="text-input" placeholder="í° ì œëª© ì…ë ¥">
                <input type="text" id="hero-subtitle-input" class="text-input" placeholder="ì‘ì€ ë¶€ì œëª© ì…ë ¥">
                <button class="btn" id="hero-text-save-btn">ë¬¸êµ¬ ì €ì¥</button>
                <button class="btn btn-danger" id="hero-text-delete-btn">ë¬¸êµ¬ ì „ì²´ ì‚­ì œ</button>
            </div>
            <h3>ì¹´í…Œê³ ë¦¬ ê´€ë¦¬</h3>
            <div class="category-form">
                <input type="text" id="new-category-input" class="text-input" placeholder="ìƒˆ ì¹´í…Œê³ ë¦¬ ì´ë¦„">
                <button class="btn" id="add-category-btn">ì¹´í…Œê³ ë¦¬ ì¶”ê°€</button>
            </div>
            <ul id="category-list-admin" class="category-list">
                </ul>
            <h3>ê°¤ëŸ¬ë¦¬ ì‚¬ì§„ ì—…ë¡œë“œ</h3>
            <div class="upload-form">
                <input type="file" class="file-input" id="image-upload" accept="image/*">
                <input type="text" placeholder="ì‚¬ì§„ ì œëª©" id="image-title" class="text-input">
                <select id="image-category-upload" class="text-input" style="padding: 8px; border: 1px solid #ddd; border-radius: 4px;">
                    <option value="">ì¹´í…Œê³ ë¦¬ ì„ íƒ</option>
                    </select>
                <button class="btn" id="upload-btn">ì‚¬ì§„ ì—…ë¡œë“œ</button>
            </div>
            <div class="gallery-admin" id="gallery-admin">
                </div>
            <button class="btn btn-block logout-btn" id="logout-btn">ë¡œê·¸ì•„ì›ƒ</button>
        </div>
        
        <div class="category-dropdown-container">
            <select id="category-dropdown" class="category-dropdown" style="width: 100%; padding: 10px; margin-bottom: 20px; border-radius: 4px; border: 1px solid #ddd;">
                <option value="ì „ì²´">ëª¨ë“  ì¹´í…Œê³ ë¦¬</option>
                </select>
        </div>
        
        <div class="gallery" id="gallery">
            </div>
    </main>
    
    <div class="modal" id="image-modal">
        <span class="close" id="close-modal">&times;</span>
        <span class="nav-btn prev-btn" id="prev-btn">&#10094;</span>
        <span class="nav-btn next-btn" id="next-btn">&#10095;</span>
        <img class="modal-content" id="modal-image">
        <div class="modal-title" id="modal-title"></div>
    </div>
    
    <div class="login-modal" id="login-modal">
        <div class="login-form">
            <h2>ê´€ë¦¬ì ë¡œê·¸ì¸</h2>
            <div class="form-group">
                <label for="username">ì•„ì´ë””</label>
                <input type="text" id="username" name="username">
            </div>
            <div class="form-group">
                <label for="password">ë¹„ë°€ë²ˆí˜¸</label>
                <input type="password" id="password" name="password">
            </div>
            <button class="btn btn-block" id="login-submit">ë¡œê·¸ì¸</button>
        </div>
    </div>

<script>
        let photos = [];
        let categories = []; // ëƒì˜¹! ì´ë ‡ê²Œ ë¹ˆ ë°”êµ¬ë‹ˆë¡œ ì‹œì‘í•˜ëŠ” ê±°ë‹¤ì˜¹!
        let heroInfo = {
            imageUrl: '/api/placeholder/1200/500?text=Loading...',
            title: 'ë¡œë”© ì¤‘ì´ë‹¤ì˜¹...',
            subtitle: 'ì ì‹œë§Œ ê¸°ë‹¤ë ¤ë‹¬ë¼ëƒ¥!'
        };
        let currentCategoryFilter = 'ì „ì²´';
        let currentModalPhotoIndex = 0;

        const gallery = document.getElementById('gallery');
        const galleryAdmin = document.getElementById('gallery-admin');
        const adminPanel = document.getElementById('admin-panel');
        const loginButton = document.getElementById('login-button');
        const loginModal = document.getElementById('login-modal');
        const loginSubmit = document.getElementById('login-submit');
        const logoutBtn = document.getElementById('logout-btn');
        const uploadBtn = document.getElementById('upload-btn');
        const imageUploadInput = document.getElementById('image-upload');
        const imageTitleInput = document.getElementById('image-title');
        const imageCategoryUploadDropdown = document.getElementById('image-category-upload');
        const imageModal = document.getElementById('image-modal');
        const modalImage = document.getElementById('modal-image');
        const modalTitleElement = document.getElementById('modal-title');
        const closeModal = document.getElementById('close-modal');
        const prevBtn = document.getElementById('prev-btn');
        const nextBtn = document.getElementById('next-btn');
        const twitterLink = document.getElementById('twitter-link');
        const categoryDropdown = document.getElementById('category-dropdown');
        const heroImageDisplay = document.getElementById('hero-image-display');
        const heroTitleDisplay = document.getElementById('hero-title-display');
        const heroSubtitleDisplay = document.getElementById('hero-subtitle-display');
        const heroImageUploadInputAdmin = document.getElementById('hero-image-upload-input');
        const heroImageUploadBtnAdmin = document.getElementById('hero-image-upload-btn');
        const adminHeroPreview = document.getElementById('admin-hero-preview');
        const heroImageDeleteBtnAdmin = document.getElementById('hero-image-delete-btn');
        const heroTitleInputAdmin = document.getElementById('hero-title-input');
        const heroSubtitleInputAdmin = document.getElementById('hero-subtitle-input');
        const heroTextSaveBtnAdmin = document.getElementById('hero-text-save-btn');
        const heroTextDeleteBtnAdmin = document.getElementById('hero-text-delete-btn');
        const newCategoryInputAdmin = document.getElementById('new-category-input');
        const addCategoryBtnAdmin = document.getElementById('add-category-btn');
        const categoryListAdmin = document.getElementById('category-list-admin');

        const DEFAULT_HERO_IMAGE_URL = '/api/placeholder/1200/500?text=Hero+Image';
        const DEFAULT_HERO_TITLE = 'ì—¬ê¸°ì— ë©‹ì§„ ì œëª©ì„!';
        const DEFAULT_HERO_SUBTITLE = 'ì—¬ê¸°ëŠ” ë¶€ì œëª©ì„ ì“°ëŠ” ê³µê°„ì´ë‹¤ì˜¹!';

     // ëƒì˜¹! init í•¨ìˆ˜ë¥¼ ì´ë ‡ê²Œ í†µì§¸ë¡œ ë°”ê¿”ì£¼ìì˜¹!
    async function init() {
        console.log("ì•¼ì˜¹! init() í•¨ìˆ˜ê°€ ì§€ê¸ˆ ë§‰ ì‹œì‘ëë‹¤ì˜¹!"); // <--- ìš°ë¦¬ê°€ ì¶”ê°€í–ˆë˜ í™•ì¸ìš© ë¡œê·¸!

        // --- ëƒì˜¹! ğŸ± ì—¬ê¸°ê°€ ë°”ë¡œ ì¹´í…Œê³ ë¦¬ë¥¼ ì„œë²„ì—ì„œ ê°€ì ¸ì˜¤ëŠ” ë¶€ë¶„ì´ë‹¤ì˜¹! ---
        try {
            console.log('ëƒì˜¹~ ì„œë²„ì—ì„œ ì¹´í…Œê³ ë¦¬ ëª©ë¡ì„ ê°€ì ¸ì˜¤ê¸° ì‹œì‘í•œë‹¤ì˜¹!');
            const response = await fetch('/.netlify/functions/get-categories'); // ìš°ë¦¬ í•¨ìˆ˜ ì£¼ì†Œ!
            if (!response.ok) {
                const errorText = await response.text(); 
                throw new Error(`ëƒì˜¹! ì„œë²„ì—ì„œ ì¹´í…Œê³ ë¦¬ ê°€ì ¸ì˜¤ê¸° ì‹¤íŒ¨: ${response.status} ${response.statusText} - ${errorText}`);
            }
            const serverCategories = await response.json(); 

            categories = serverCategories; // ì„œë²„ì—ì„œ ì´ë¯¸ {id, name} ê°ì²´ ë°°ì—´ë¡œ ì˜¨ë‹¤ì˜¹! ê·¸ëŒ€ë¡œ ì“°ìëƒ¥!
            
            console.log('ì„œë²„ì—ì„œ ì¹´í…Œê³ ë¦¬ ì„±ê³µì ìœ¼ë¡œ ê°€ì ¸ì™”ë‹¤ì˜¹!', categories);

        } catch (error) {
            console.error('ì„œë²„ì—ì„œ ì¹´í…Œê³ ë¦¬ ê°€ì ¸ì˜¤ë‹¤ê°€ ì—ëŸ¬ë‹¤ì˜¹ ã… ã… :', error);
            categories = ['í’ê²½', 'ì¸ë¬¼', 'ê¸°ë³¸ê°’ì´ë‹¤ì˜¹']; // ì˜ˆì‹œ: ì—ëŸ¬ ì‹œ ê¸°ë³¸ ì¹´í…Œê³ ë¦¬
            alert('ëƒì˜¹... ì„œë²„ì—ì„œ ì¹´í…Œê³ ë¦¬ ëª©ë¡ì„ ê°€ì ¸ì˜¤ëŠ”ë° ì‹¤íŒ¨í•´ì„œ ì„ì‹œ ëª©ë¡ì„ ë³´ì—¬ì¤€ë‹¤ì˜¹. ìƒˆë¡œê³ ì¹¨ í•´ë³´ë¼ëƒ¥!');
        }


            try {
                const heroResponse = await fetch('/.netlify/functions/get-hero-info');
                if (heroResponse.ok) {
                    const heroData = await heroResponse.json();
                    heroInfo.title = heroData.title || DEFAULT_HERO_TITLE;
                    heroInfo.subtitle = heroData.subtitle || DEFAULT_HERO_SUBTITLE;
                    heroInfo.imageUrl = heroData.imageUrl || DEFAULT_HERO_IMAGE_URL;
                } else {
                    console.error('init: íˆì–´ë¡œ ì •ë³´ ê°€ì ¸ì˜¤ê¸° ì‹¤íŒ¨ (ì„œë²„ ì‘ë‹µ):', await heroResponse.text());
                    setDefaultHeroInfo();
                }
            } catch (e) {
                console.error('init: íˆì–´ë¡œ ì •ë³´ ê°€ì ¸ì˜¤ëŠ” ì¤‘ ë„¤íŠ¸ì›Œí¬ ì—ëŸ¬:', e);
                setDefaultHeroInfo();
            }
            updateHeroSection();

            try {
                const photosResponse = await fetch('/.netlify/functions/get-photos');
                if (photosResponse.ok) {
                    const photosData = await photosResponse.json();
                    photos = photosData;
                } else {
                    console.error('init: ê°¤ëŸ¬ë¦¬ ì‚¬ì§„ ëª©ë¡ ê°€ì ¸ì˜¤ê¸° ì‹¤íŒ¨ (ì„œë²„ ì‘ë‹µ):', await photosResponse.text());
                    photos = [];
                }
            } catch (e) {
                console.error('init: ê°¤ëŸ¬ë¦¬ ì‚¬ì§„ ëª©ë¡ ê°€ì ¸ì˜¤ëŠ” ì¤‘ ë„¤íŠ¸ì›Œí¬ ì—ëŸ¬:', e);
                photos = [];
            }

            try {
                const heroResponse = await fetch('/.netlify/functions/get-hero-info');
                if (heroResponse.ok) {
                    const heroData = await heroResponse.json();
                    heroInfo.title = heroData.title || DEFAULT_HERO_TITLE;
                    heroInfo.subtitle = heroData.subtitle || DEFAULT_HERO_SUBTITLE;
                    heroInfo.imageUrl = heroData.imageUrl || DEFAULT_HERO_IMAGE_URL;
                } else {
                    console.error('init: íˆì–´ë¡œ ì •ë³´ ê°€ì ¸ì˜¤ê¸° ì‹¤íŒ¨ (ì„œë²„ ì‘ë‹µ):', await heroResponse.text());
                    setDefaultHeroInfo();
                }
            } catch (e) {
                console.error('init: íˆì–´ë¡œ ì •ë³´ ê°€ì ¸ì˜¤ëŠ” ì¤‘ ë„¤íŠ¸ì›Œí¬ ì—ëŸ¬:', e);
                setDefaultHeroInfo();
            }
            updateHeroSection();

            try {
                const photosResponse = await fetch('/.netlify/functions/get-photos');
                if (photosResponse.ok) {
                    const photosData = await photosResponse.json();
                    photos = photosData;
                } else {
                    console.error('init: ê°¤ëŸ¬ë¦¬ ì‚¬ì§„ ëª©ë¡ ê°€ì ¸ì˜¤ê¸° ì‹¤íŒ¨ (ì„œë²„ ì‘ë‹µ):', await photosResponse.text());
                    photos = [];
                }
            } catch (e) {
                console.error('init: ê°¤ëŸ¬ë¦¬ ì‚¬ì§„ ëª©ë¡ ê°€ì ¸ì˜¤ëŠ” ì¤‘ ë„¤íŠ¸ì›Œí¬ ì—ëŸ¬:', e);
                photos = [];
            }
            
            populateAllCategoryDropdowns(); // ì¹´í…Œê³ ë¦¬ ë¨¼ì € ì±„ìš°ê³ 
            renderGallery(); // ê·¸ ë‹¤ìŒ ê°¤ëŸ¬ë¦¬ ë Œë”ë§
            checkLogin(); // ë¡œê·¸ì¸ ìƒíƒœ í™•ì¸ ë° ì–´ë“œë¯¼ UI ì²˜ë¦¬
            setupEventListeners();
        }

        function setDefaultHeroInfo() {
            heroInfo.title = DEFAULT_HERO_TITLE;
            heroInfo.subtitle = DEFAULT_HERO_SUBTITLE;
            heroInfo.imageUrl = DEFAULT_HERO_IMAGE_URL;
        }

        function updateHeroSection() {
            heroImageDisplay.src = heroInfo.imageUrl || DEFAULT_HERO_IMAGE_URL;
            heroTitleDisplay.textContent = heroInfo.title || ''; // textContentë¡œ ë³€ê²½
            heroSubtitleDisplay.textContent = heroInfo.subtitle || ''; // textContentë¡œ ë³€ê²½

            if (adminPanel.style.display === 'block') {
                adminHeroPreview.src = heroInfo.imageUrl || '/api/placeholder/400/150?text=No+Image';
                heroTitleInputAdmin.value = heroInfo.title || '';
                heroSubtitleInputAdmin.value = heroInfo.subtitle || '';
            }
        }

        async function handleHeroImageUpload() {
            const file = heroImageUploadInputAdmin.files[0];
            if (!file) { alert('íˆì–´ë¡œ ì´ë¯¸ì§€ë¥¼ ì„ íƒí•´ë‹¬ë¼ì˜¹!'); return; }

            const formData = new FormData();
            formData.append('imageFile', file);
            // ì œëª©ê³¼ ë¶€ì œëª©ì€ ì„œë²„ì—ì„œ í˜„ì¬ ê°’ì„ ì½ë„ë¡ í´ë¼ì´ì–¸íŠ¸ì—ì„œëŠ” ë³´ë‚´ì§€ ì•Šê±°ë‚˜,
            // ë§Œì•½ í˜„ì¬ ì…ë ¥ëœ ê°’ìœ¼ë¡œ ì—…ë°ì´íŠ¸í•˜ê³  ì‹¶ë‹¤ë©´ í•¨ê»˜ ë³´ë‚¼ ìˆ˜ ìˆë‹¤ì˜¹.
            // ì—¬ê¸°ì„œëŠ” í˜„ì¬ ì…ë ¥ í•„ë“œì˜ ê°’ ë˜ëŠ” ê¸°ì¡´ heroInfo ê°’ì„ ì‚¬ìš©í•œë‹¤ì˜¹.
            formData.append('heroTitle', heroTitleInputAdmin.value.trim() || heroInfo.title);
            formData.append('heroSubtitle', heroSubtitleInputAdmin.value.trim() || heroInfo.subtitle);

            try {
                const response = await fetch('/.netlify/functions/upload-hero-image', { method: 'POST', body: formData });
                if (!response.ok) {
                    const errorResult = await response.json();
                    throw new Error(errorResult.message || 'Netlify Functionì—ì„œ íˆì–´ë¡œ ì´ë¯¸ì§€ ì—…ë¡œë“œ ì‹¤íŒ¨!');
                }
                const result = await response.json();
                heroInfo.imageUrl = result.publicUrl; 
                // ì„œë²„ì—ì„œ ì œëª©/ë¶€ì œëª©ë„ ê°™ì´ ì—…ë°ì´íŠ¸ í–ˆë‹¤ë©´, ê·¸ ê°’ì„ ë°›ì•„ì™€ì„œ heroInfoì— ë°˜ì˜í•  ìˆ˜ ìˆë‹¤ì˜¹.
                // ì—¬ê¸°ì„œëŠ” ì—…ë¡œë“œ ì‹œ ì‚¬ìš©ëœ ê°’ì„ heroInfoì— ë°˜ì˜í•œë‹¤ì˜¹.
                heroInfo.title = heroTitleInputAdmin.value.trim() || heroInfo.title;
                heroInfo.subtitle = heroSubtitleInputAdmin.value.trim() || heroInfo.subtitle;

                updateHeroSection();
                alert('íˆì–´ë¡œ ì´ë¯¸ì§€ê°€ ì„±ê³µì ìœ¼ë¡œ ì—…ë¡œë“œ ë° ì €ì¥ë˜ì—ˆë‹¤ì˜¹!');
            } catch (error) {
                console.error('íˆì–´ë¡œ ì´ë¯¸ì§€ ì—…ë¡œë“œ ì¤‘ ì—ëŸ¬:', error);
                alert(`ëƒì˜¹... íˆì–´ë¡œ ì´ë¯¸ì§€ ì—…ë¡œë“œ ì‹¤íŒ¨: ${error.message}`);
            } finally {
                heroImageUploadInputAdmin.value = ''; // íŒŒì¼ ì…ë ¥ í•„ë“œ ì´ˆê¸°í™”
            }
        }

        async function deleteHeroImage() {
            if (confirm('ì •ë§ë¡œ íˆì–´ë¡œ ì´ë¯¸ì§€ë¥¼ ê¸°ë³¸ ì´ë¯¸ì§€ë¡œ ë˜ëŒë¦´ê±°ëƒ¥?')) {
                try {
                    // ì„œë²„ì— ì´ë¯¸ì§€ URLë§Œ ê¸°ë³¸ê°’ìœ¼ë¡œ ì—…ë°ì´íŠ¸ ìš”ì²­ (ì œëª©/ë¶€ì œëª©ì€ í˜„ì¬ ê°’ ìœ ì§€ ë˜ëŠ” ê¸°ë³¸ê°’ìœ¼ë¡œ)
                    const response = await fetch('/.netlify/functions/update-hero-text', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ 
                            title: heroInfo.title, // í˜„ì¬ ì œëª© ìœ ì§€ ë˜ëŠ” DEFAULT_HERO_TITLE
                            subtitle: heroInfo.subtitle, // í˜„ì¬ ë¶€ì œëª© ìœ ì§€ ë˜ëŠ” DEFAULT_HERO_SUBTITLE
                            imageUrl: DEFAULT_HERO_IMAGE_URL 
                        })
                    });
                    if(response.ok){
                        heroInfo.imageUrl = DEFAULT_HERO_IMAGE_URL; // í´ë¼ì´ì–¸íŠ¸ heroInfo ì—…ë°ì´íŠ¸
                        // í•„ìš”í•˜ë‹¤ë©´ title, subtitleë„ ê¸°ë³¸ê°’ìœ¼ë¡œ ì„¤ì •
                        // heroInfo.title = DEFAULT_HERO_TITLE;
                        // heroInfo.subtitle = DEFAULT_HERO_SUBTITLE;
                        updateHeroSection();
                        alert('íˆì–´ë¡œ ì´ë¯¸ì§€ê°€ ê¸°ë³¸ê°’ìœ¼ë¡œ ë³€ê²½ë˜ì—ˆë‹¤ì˜¹!');
                    } else { 
                        const errorText = await response.text();
                        throw new Error(errorText || 'íˆì–´ë¡œ ì´ë¯¸ì§€ ê¸°ë³¸ê°’ ë³€ê²½ ì‹¤íŒ¨'); 
                    }
                } catch (error) {
                    console.error('íˆì–´ë¡œ ì´ë¯¸ì§€ ê¸°ë³¸ê°’ìœ¼ë¡œ ë³€ê²½ ì‹¤íŒ¨:', error);
                    alert('ëƒì˜¹... íˆì–´ë¡œ ì´ë¯¸ì§€ ì´ˆê¸°í™”ì— ì‹¤íŒ¨í–ˆë‹¤ì˜¹.');
                }
            }
        }
        
        async function saveHeroText() {
            const titleToSave = heroTitleInputAdmin.value.trim();
            const subtitleToSave = heroSubtitleInputAdmin.value.trim();
            // ì´ë¯¸ì§€ URLì€ í˜„ì¬ heroInfoì˜ ê²ƒì„ ì‚¬ìš©í•œë‹¤ì˜¹.
            const currentImageUrl = heroInfo.imageUrl || DEFAULT_HERO_IMAGE_URL;

            try {
                const response = await fetch('/.netlify/functions/update-hero-text', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ title: titleToSave, subtitle: subtitleToSave, imageUrl: currentImageUrl })
                });

                if (response.ok) {
                    const result = await response.json(); // ì„œë²„ì—ì„œ ë°˜í™˜ëœ ë°ì´í„° ì‚¬ìš©
                    heroInfo.title = result.data.title;
                    heroInfo.subtitle = result.data.subtitle;
                    heroInfo.imageUrl = result.data.imageUrl; // imageUrlë„ ì„œë²„ ì‘ë‹µìœ¼ë¡œ ì—…ë°ì´íŠ¸
                    updateHeroSection();
                    alert('íˆì–´ë¡œ ë¬¸êµ¬ê°€ Firestoreì— ì €ì¥ë˜ì—ˆë‹¤ì˜¹!');
                } else { 
                    const errorText = await response.text();
                    throw new Error(errorText || 'íˆì–´ë¡œ ë¬¸êµ¬ ì €ì¥ ì‹¤íŒ¨'); 
                }
            } catch (error) {
                console.error('íˆì–´ë¡œ ë¬¸êµ¬ ì €ì¥ ì‹¤íŒ¨:', error);
                alert(`ëƒì˜¹... íˆì–´ë¡œ ë¬¸êµ¬ ì €ì¥ì— ì‹¤íŒ¨í–ˆë‹¤ì˜¹: ${error.message}`);
            }
        }

        async function deleteHeroText() {
             if (confirm('ì •ë§ë¡œ íˆì–´ë¡œ ë¬¸êµ¬ë¥¼ ê¸°ë³¸ê°’ìœ¼ë¡œ ë˜ëŒë¦´ê±°ëƒ¥?')) {
                try {
                     // ì´ë¯¸ì§€ URLì€ í˜„ì¬ heroInfoì˜ ê²ƒì„ ì‚¬ìš©í•œë‹¤ì˜¹.
                    const currentImageUrl = heroInfo.imageUrl || DEFAULT_HERO_IMAGE_URL;
                    const response = await fetch('/.netlify/functions/update-hero-text', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ 
                            title: DEFAULT_HERO_TITLE, 
                            subtitle: DEFAULT_HERO_SUBTITLE, 
                            imageUrl: currentImageUrl // í˜„ì¬ ì´ë¯¸ì§€ URLì€ ìœ ì§€í•˜ë©´ì„œ í…ìŠ¤íŠ¸ë§Œ ê¸°ë³¸ê°’ìœ¼ë¡œ
                        })
                    });
                     if(response.ok){
                        heroInfo.title = DEFAULT_HERO_TITLE;
                        heroInfo.subtitle = DEFAULT_HERO_SUBTITLE;
                        // heroInfo.imageUrlì€ ë³€ê²½í•˜ì§€ ì•ŠìŒ (í…ìŠ¤íŠ¸ë§Œ ì‚­ì œ)
                        updateHeroSection();
                        alert('íˆì–´ë¡œ ë¬¸êµ¬ê°€ ê¸°ë³¸ê°’ìœ¼ë¡œ ì´ˆê¸°í™”ë˜ì—ˆë‹¤ì˜¹!');
                    } else { 
                        const errorText = await response.text();
                        throw new Error(errorText || 'íˆì–´ë¡œ ë¬¸êµ¬ ì´ˆê¸°í™” ì‹¤íŒ¨');
                    }
                } catch (error) {
                    console.error('íˆì–´ë¡œ ë¬¸êµ¬ ê¸°ë³¸ê°’ìœ¼ë¡œ ë³€ê²½ ì‹¤íŒ¨:', error);
                    alert('ëƒì˜¹... íˆì–´ë¡œ ë¬¸êµ¬ ì´ˆê¸°í™”ì— ì‹¤íŒ¨í–ˆë‹¤ì˜¹.');
                }
            }
        }
        
function populateAllCategoryDropdowns() {
    console.log('populateAllCategoryDropdowns ì‹œì‘! í˜„ì¬ categories:', JSON.parse(JSON.stringify(categories))); // categories ë‚´ìš© í™•ì¸ (ìˆœí™˜ ì°¸ì¡° ë°©ì§€)
    console.log('í˜„ì¬ photos:', photos.length > 0 ? photos.slice(0,2) : 'ì‚¬ì§„ ì—†ìŒ'); // ì‚¬ì§„ ì¼ë¶€ í™•ì¸

    // 1. categories (ì „ì—­ ê°ì²´ ë°°ì—´)ì—ì„œ ì¹´í…Œê³ ë¦¬ "ì´ë¦„"ë§Œ ì¶”ì¶œí•œë‹¤ì˜¹.
    const categoryNamesFromGlobal = categories.map(cat => cat.name);
    console.log('categoryNamesFromGlobal (ì´ë¦„ë§Œ ì¶”ì¶œ):', categoryNamesFromGlobal);

    // 2. photos ë°°ì—´ì—ì„œ ì‹¤ì œ ì‚¬ìš©ëœ ì¹´í…Œê³ ë¦¬ "ì´ë¦„" ëª©ë¡ì„ ê°€ì ¸ì˜¨ë‹¤ì˜¹ (ì¤‘ë³µ ì œê±° ë° ì •ë ¬).
    const uniqueCategoryNamesFromPhotos = photos.length > 0 
        ? [...new Set(photos.map(p => p.category).filter(catName => catName && typeof catName === 'string' && catName.trim() !== ''))].sort() 
        : [];
    console.log('uniqueCategoryNamesFromPhotos (ì‚¬ì§„ì—ì„œ ì¶”ì¶œí•œ ì´ë¦„):', uniqueCategoryNamesFromPhotos);
    
    // 3. ìœ„ ë‘ ì´ë¦„ ëª©ë¡ì„ í•©ì¹˜ê³ , ë‹¤ì‹œ í•œë²ˆ ì¤‘ë³µì„ ì œê±°í•˜ê³ , ìµœì¢…ì ìœ¼ë¡œ ì •ë ¬ëœ "ì´ë¦„" ëª©ë¡ì„ ë§Œë“ ë‹¤ì˜¹.
    //    ì´ê²ƒì´ ë°”ë¡œ ëª¨ë“  ë“œë¡­ë‹¤ìš´ì— í‘œì‹œë  ì¹´í…Œê³ ë¦¬ ì´ë¦„ë“¤ì´ë‹¤ëƒ¥!
    let displayCategoryNames = [...new Set([...categoryNamesFromGlobal, ...uniqueCategoryNamesFromPhotos])]
                                .filter(catName => catName && typeof catName === 'string' && catName.trim() !== '') // ìµœì¢…ì ìœ¼ë¡œ ë¬¸ìì—´ì´ê³  ë¹„ì–´ìˆì§€ ì•Šì€ ê²ƒë§Œ!
                                .sort((a, b) => a.localeCompare(b)); // ì´ë¦„ìˆœ ì •ë ¬!
    console.log('ìµœì¢… displayCategoryNames (ë“œë¡­ë‹¤ìš´ìš© ì´ë¦„ ëª©ë¡):', displayCategoryNames);

    // ë§Œì•½ displayCategoryNamesê°€ ë¹„ì—ˆëŠ”ë°, categories (ê°ì²´ë°°ì—´)ì—ëŠ” ì¹´í…Œê³ ë¦¬ê°€ ìˆì—ˆë‹¤ë©´,
    // (ì˜ˆ: ì‚¬ì§„ì— ì•„ì§ ì¹´í…Œê³ ë¦¬ê°€ ì‚¬ìš©ë˜ì§€ ì•Šì•˜ì§€ë§Œ, ê´€ë¦¬ìê°€ ì¹´í…Œê³ ë¦¬ë¥¼ ë§Œë“¤ì–´ë‘” ê²½ìš°)
    // categoriesì— ìˆëŠ” ì´ë¦„ë“¤ì„ ì‚¬ìš©í•œë‹¤ì˜¹.
    if (displayCategoryNames.length === 0 && categoryNamesFromGlobal.length > 0) {
        displayCategoryNames = [...categoryNamesFromGlobal].sort((a, b) => a.localeCompare(b));
        console.log('ì‚¬ì§„ì— ì¹´í…Œê³ ë¦¬ ì—†ì§€ë§Œ, ì „ì—­ ì¹´í…Œê³ ë¦¬ ìˆì–´ì„œ displayCategoryNames ì—…ë°ì´íŠ¸:', displayCategoryNames);
    } else if (displayCategoryNames.length === 0 && categoryNamesFromGlobal.length === 0) {
        // ì•„ë¬´ ì¹´í…Œê³ ë¦¬ë„ ì—†ì„ ë•Œ (ì‚¬ì§„ì—ë„ ì—†ê³ , ê´€ë¦¬ìê°€ ë§Œë“  ê²ƒë„ ì—†ì„ ë•Œ)
        console.log('í‘œì‹œí•  ì¹´í…Œê³ ë¦¬ ì´ë¦„ì´ í•˜ë‚˜ë„ ì—†ë‹¤ì˜¹!');
        // í•„ìš”í•˜ë‹¤ë©´ ì—¬ê¸°ì— 'ì¹´í…Œê³ ë¦¬ ì—†ìŒ' ê°™ì€ ê¸°ë³¸ ë©”ì‹œì§€ë¥¼ ë“œë¡­ë‹¤ìš´ì— í‘œì‹œí•  ìˆ˜ë„ ìˆë‹¤ì˜¹.
    }

    // --- ì´ì œ ì´ displayCategoryNames (ë¬¸ìì—´ ë°°ì—´)ë¥¼ ì‚¬ìš©í•´ì„œ ë“œë¡­ë‹¤ìš´ë“¤ì„ ì±„ìš´ë‹¤ì˜¹ ---

    // ë©”ì¸ í™”ë©´ ì¹´í…Œê³ ë¦¬ ë“œë¡­ë‹¤ìš´ ì—…ë°ì´íŠ¸
    categoryDropdown.innerHTML = '<option value="ì „ì²´">ëª¨ë“  ì¹´í…Œê³ ë¦¬</option>'; // ê¸°ë³¸ 'ì „ì²´' ì˜µì…˜
    displayCategoryNames.forEach(categoryName => { // categoryNameì€ ì´ì œ í•­ìƒ ë¬¸ìì—´ì´ë‹¤ì˜¹!
        const count = photos.filter(p => p.category === categoryName).length;
        const option = document.createElement('option');
        option.value = categoryName;
        option.textContent = `${categoryName} (${count})`; 
        categoryDropdown.appendChild(option);
    });
    categoryDropdown.value = currentCategoryFilter; // í˜„ì¬ í•„í„° ìœ ì§€

    // ê´€ë¦¬ì íŒ¨ë„ì˜ ì‚¬ì§„ ì—…ë¡œë“œìš© ì¹´í…Œê³ ë¦¬ ë“œë¡­ë‹¤ìš´ ì—…ë°ì´íŠ¸
    imageCategoryUploadDropdown.innerHTML = '<option value="">ì¹´í…Œê³ ë¦¬ ì„ íƒ</option>'; // ê¸°ë³¸ 'ì„ íƒ' ì˜µì…˜
    displayCategoryNames.forEach(categoryName => { // categoryNameì€ ì´ì œ í•­ìƒ ë¬¸ìì—´ì´ë‹¤ì˜¹!
        const option = document.createElement('option');
        option.value = categoryName;
        option.textContent = categoryName; // ì—¬ê¸°ëŠ” ì¹´í…Œê³ ë¦¬ ì´ë¦„ë§Œ!
        imageCategoryUploadDropdown.appendChild(option);
    });

    // ê´€ë¦¬ì íŒ¨ë„ì˜ ì¹´í…Œê³ ë¦¬ ëª©ë¡ (ì¶”ê°€/ì‚­ì œìš©) ì—…ë°ì´íŠ¸
    // ì´ ëª©ë¡ì€ renderAdminCategoryList í•¨ìˆ˜ê°€ ë‹´ë‹¹í•˜ê³ , ê·¸ í•¨ìˆ˜ëŠ” ì „ì—­ categories (ê°ì²´ ë°°ì—´)ë¥¼ ì§ì ‘ ì‚¬ìš©í•œë‹¤ì˜¹.
    if (adminPanel.style.display === 'block') {
        // â­ ì¤‘ìš”: renderAdminCategoryListë¥¼ ì¸ì ì—†ì´ í˜¸ì¶œí•œë‹¤ì˜¹! â­
        renderAdminCategoryList(); 
    }
    console.log('populateAllCategoryDropdowns ëë‚¬ë‹¤ì˜¹!');
}

// ê¸°ì¡´ í•¨ìˆ˜ ì„ ì–¸: function renderAdminCategoryList(catsToDisplay = []) { ... }
// ì•„ë˜ì²˜ëŸ¼ ë§¤ê°œë³€ìˆ˜ë¥¼ ì—†ì• ê³ , ì „ì—­ `categories` ë³€ìˆ˜ë¥¼ ì§ì ‘ ì‚¬ìš©í•˜ë„ë¡ í•˜ìì˜¹!

function renderAdminCategoryList() {
    categoryListAdmin.innerHTML = ''; // ëª©ë¡ì„ ê¹¨ë—í•˜ê²Œ ë¹„ìš°ëŠ” ê±´ ê·¸ëŒ€ë¡œ!

    // ì „ì—­ ë³€ìˆ˜ `categories`ëŠ” ì´ì œ {id: '...', name: '...'} í˜•íƒœì˜ ê°ì²´ ë°°ì—´ì´ë‹¤ì˜¹!
    // (init í•¨ìˆ˜ì™€ refreshCategoriesFromServer í•¨ìˆ˜ì—ì„œ ì´ë ‡ê²Œ ì±„ì›Œì£¼ê¸°ë¡œ í–ˆë‹¤ëƒ¥!)

    if (!categories || categories.length === 0) {
        const listItem = document.createElement('li');
        listItem.textContent = 'ì•„ì§ ê´€ë¦¬í•  ì¹´í…Œê³ ë¦¬ê°€ ì—†ë‹¤ì˜¹. ìƒˆë¡œ ì¶”ê°€í•´ë³´ë¼ëƒ¥!';
        // ë³´ê¸° ì¢‹ê²Œ ìŠ¤íƒ€ì¼ë„ ì‚´ì§ ì¶”ê°€ (ì„ íƒ ì‚¬í•­)
        listItem.style.textAlign = 'center';
        listItem.style.color = '#777';
        listItem.style.padding = '10px 0';
        categoryListAdmin.appendChild(listItem);
        return; // ì¹´í…Œê³ ë¦¬ ì—†ìœ¼ë©´ ì—¬ê¸°ì„œ ë!
    }
    
    // ì¹´í…Œê³ ë¦¬ ì´ë¦„ì„ ê¸°ì¤€ìœ¼ë¡œ ê°€ë‚˜ë‹¤ ìˆœìœ¼ë¡œ ì •ë ¬í•´ì„œ ë³´ì—¬ì£¼ìì˜¹ (ì„ íƒ ì‚¬í•­ì´ì§€ë§Œ ë³´ê¸° ì¢‹ë‹¤ëƒ¥!)
    const sortedCategories = [...categories].sort((a, b) => {
        // í˜¹ì‹œ nameì´ ì—†ëŠ” ê°ì²´ê°€ ìˆì„ê¹Œë´ ë°©ì–´ ì½”ë“œ ì¶”ê°€ (ê·¸ëŸ´ ì¼ ì—†ì–´ì•¼ í•˜ì§€ë§Œ!)
        const nameA = a.name || '';
        const nameB = b.name || '';
        return nameA.localeCompare(nameB); // ì´ë¦„ìœ¼ë¡œ ì •ë ¬!
    });

    sortedCategories.forEach(category => { // 'category'ëŠ” ì´ì œ í•­ìƒ {id: '...', name: '...'} ê°ì²´ë‹¤ì˜¹!
        const listItem = document.createElement('li');
        
        // â­ 1. ê° ë¦¬ìŠ¤íŠ¸ ì•„ì´í…œì— ê³ ìœ  ID ë¶€ì—¬! â­
        // ë‚˜ì¤‘ì— ì‚­ì œ ì„±ê³µ ì‹œ í™”ë©´ì—ì„œ ì´ IDë¡œ li ìš”ì†Œë¥¼ ì°¾ì•„ ì§€ìš¸ ìˆ˜ ìˆë‹¤ì˜¹!
        listItem.id = `admin-category-li-${category.id}`; 
        
        // â­ 2. í™”ë©´ì—ëŠ” ì¹´í…Œê³ ë¦¬ ì´ë¦„(category.name)ì„ í‘œì‹œ! â­
        listItem.textContent = category.name; 

        const deleteButton = document.createElement('button');
        deleteButton.textContent = 'ì‚­ì œ';
        deleteButton.className = 'btn btn-danger btn-sm'; // ìŠ¤íƒ€ì¼ì€ ê·¸ëŒ€ë¡œ!

        // â­ 3. ì‚­ì œ ë²„íŠ¼ í´ë¦­ ì‹œ handleDeleteCategory í•¨ìˆ˜ì— category.id ì™€ category.nameì„ ì „ë‹¬! â­
        deleteButton.onclick = () => handleDeleteCategory(category.id, category.name); 
                                     // â†‘â†‘â†‘ ìš”ê¸°ê°€ í•µì‹¬ì´ë‹¤ëƒ¥! â†‘â†‘â†‘

        listItem.appendChild(deleteButton);
        categoryListAdmin.appendChild(listItem);
    });
    console.log('ê´€ë¦¬ì ì¹´í…Œê³ ë¦¬ ëª©ë¡ (ê°ì²´ ê¸°ë°˜, ì „ì—­ categories ì‚¬ìš©) ë Œë”ë§ ì™„ë£Œ!', sortedCategories);
}

// â­â­ ì—¬ê¸°ì— ìƒˆë¡œìš´ handleDeleteCategory í•¨ìˆ˜ë¥¼ ë„£ì–´ì£¼ì„¸ìš”ì˜¹! â­â­
async function handleDeleteCategory(categoryId, categoryName) {
    console.log(`ì‚­ì œ ë²„íŠ¼ í´ë¦­! ID: ${categoryId}, ì´ë¦„: ${categoryName} (handleDeleteCategory ì‹œì‘)`);

    if (!confirm(`ì •ë§ë¡œ '${categoryName}' ì¹´í…Œê³ ë¦¬ë¥¼ ì‚­ì œí• ê±°ëƒ¥? ì´ ì‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ë‹¤ì˜¹!`)) {
        console.log('ì¹´í…Œê³ ë¦¬ ì‚­ì œ ì·¨ì†Œë¨ (handleDeleteCategory)');
        return; // ì•„ë‹ˆì˜¤! í•˜ë©´ ì—¬ê¸°ì„œ ë!
    }

    // ë¡œë”© ì¸ë””ì¼€ì´í„°ê°€ ìˆë‹¤ë©´ ì—¬ê¸°ì„œ ë³´ì—¬ì£¼ë©´ ì¢‹ë‹¤ì˜¹!
    // showLoadingIndicator(); 

    try {
        console.log(`ì„œë²„ì— ì¹´í…Œê³ ë¦¬(ID: ${categoryId}) ì‚­ì œ ìš”ì²­ ë³´ë‚¸ë‹¤ì˜¹... (handleDeleteCategory)`);

        const response = await fetch('/.netlify/functions/delete-category', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({ id: categoryId }), // ì‚­ì œí•  ì¹´í…Œê³ ë¦¬ IDë¥¼ ë³´ë‚¸ë‹¤ì˜¹!
        });

        const contentType = response.headers.get("content-type");
        let resultData;
        if (contentType && contentType.indexOf("application/json") !== -1) {
            resultData = await response.json();
        } else {
            const textResult = await response.text();
            console.warn('ì„œë²„ ì‘ë‹µì´ JSON í˜•ì‹ì´ ì•„ë‹ˆë‹¤ì˜¹ (delete-category ì‘ë‹µ):', textResult);
            resultData = { message: textResult }; // ì˜¤ë¥˜ ì²˜ë¦¬ë¥¼ ìœ„í•´ ê¸°ë³¸ ë©”ì‹œì§€ë¡œ ì„¤ì •
        }

        if (!response.ok) {
            const errorMessage = resultData.message || `HTTP ì—ëŸ¬ ${response.status} - ${response.statusText}`;
            throw new Error(errorMessage);
        }

        console.log('ì„œë²„ì—ì„œ ì¹´í…Œê³ ë¦¬ ì‚­ì œ ì„±ê³µ! ì‘ë‹µ:', resultData, '(handleDeleteCategory)');
        alert(`'${categoryName}' ì¹´í…Œê³ ë¦¬ê°€ ì„±ê³µì ìœ¼ë¡œ ì‚­ì œë˜ì—ˆë‹¤ì˜¹! ëƒ¥! (ì„œë²„ ë©”ì‹œì§€: ${resultData.message})`);

        // í™”ë©´ì—ì„œ í•´ë‹¹ ì¹´í…Œê³ ë¦¬ li ìš”ì†Œë¥¼ ì‚­ì œí•˜ìì˜¹!
        // listItemì— IDë¥¼ 'admin-category-li-' + categoryId ë¡œ ì„¤ì •í–ˆì—ˆë‹¤ì˜¹!
        const listItemToRemove = document.getElementById(`admin-category-li-${categoryId}`);
        if (listItemToRemove) {
            listItemToRemove.remove();
            console.log(`í™”ë©´ì—ì„œ '${categoryName}' (ID: ${categoryId}) ì¹´í…Œê³ ë¦¬ í•­ëª© ì‚­ì œ ì™„ë£Œ! (handleDeleteCategory)`);
        } else {
            console.warn(`í™”ë©´ì—ì„œ ì¹´í…Œê³ ë¦¬ í•­ëª©(li ID: admin-category-li-${categoryId})ì„ ì°¾ì§€ ëª»í–ˆë‹¤ì˜¹. (handleDeleteCategory)`);
            // ëª» ì°¾ì•˜ìœ¼ë©´ ì „ì²´ ëª©ë¡ì„ ë‹¤ì‹œ ë¶ˆëŸ¬ì˜¤ëŠ” ê²ƒë„ ë°©ë²•ì´ë‹¤ì˜¹!
            // refreshCategoriesFromServer(); // ì´ ë°©ë²•ë„ ì¢‹ë‹¤ëƒ¥!
        }
        
        // ì‚­ì œ í›„, ì „ì²´ ì¹´í…Œê³ ë¦¬ ëª©ë¡ (categories ë³€ìˆ˜)ë„ ì—…ë°ì´íŠ¸ í•´ì£¼ëŠ” ê²Œ ì¢‹ë‹¤ì˜¹!
        // ê·¸ë¦¬ê³  ë‹¤ë¥¸ ë“œë¡­ë‹¤ìš´ë“¤ë„ ì—…ë°ì´íŠ¸!
        await refreshCategoriesFromServer(); // ì‚­ì œ ì„±ê³µí–ˆìœ¼ë‹ˆ ì„œë²„ì—ì„œ ìµœì‹  ëª©ë¡ì„ ë‹¤ì‹œ ë°›ì•„ì˜¤ìì˜¹!

        // ë§Œì•½ ëª©ë¡ì´ ë‹¤ ë¹„ì—ˆìœ¼ë©´ "ì¹´í…Œê³ ë¦¬ ì—†ë‹¤ì˜¹" ë©”ì‹œì§€ë¥¼ ë‹¤ì‹œ í‘œì‹œí•  ìˆ˜ë„ ìˆë‹¤ì˜¹.
        // (refreshCategoriesFromServer ì•ˆì—ì„œ populateAllCategoryDropdownsë¥¼ í˜¸ì¶œí•˜ê³ ,
        // ê·¸ ì•ˆì—ì„œ renderAdminCategoryListê°€ í˜¸ì¶œë˜ë©´ì„œ ë¹ˆ ëª©ë¡ ë©”ì‹œì§€ë¥¼ ì²˜ë¦¬í•  ê±°ë‹¤ì˜¹!)


    } catch (error) {
        console.error('ì¹´í…Œê³ ë¦¬ ì‚­ì œ ì¤‘ ì—ëŸ¬ ë°œìƒ ã… ã…  (handleDeleteCategory):', error);
        alert(`ì¹´í…Œê³ ë¦¬ ì‚­ì œì— ì‹¤íŒ¨í–ˆë‹¤ì˜¹... ëƒì•™... (${error.message})`);
    } finally {
        // ë¡œë”© ì¸ë””ì¼€ì´í„°ê°€ ìˆë‹¤ë©´ ì—¬ê¸°ì„œ ìˆ¨ê²¨ì£¼ë©´ ì¢‹ë‹¤ì˜¹!
        // hideLoadingIndicator();
    }
}

async function handleAddCategory() {
    const newCategoryName = newCategoryInputAdmin.value.trim();
    if (!newCategoryName) {
        alert('ì¹´í…Œê³ ë¦¬ ì´ë¦„ì„ ì…ë ¥í•´ë‹¬ë¼ì˜¹!');
        return;
    }
    // "ì „ì²´"ë¼ëŠ” ì´ë¦„ì˜ ì¹´í…Œê³ ë¦¬ëŠ” ë§Œë“¤ ìˆ˜ ì—†ê²Œ í•˜ìì˜¹!
    if (newCategoryName.toLowerCase() === 'ì „ì²´') {
        alert("'ì „ì²´'ëŠ” ì¹´í…Œê³ ë¦¬ ì´ë¦„ìœ¼ë¡œ ì‚¬ìš©í•  ìˆ˜ ì—†ë‹¤ì˜¹!");
        newCategoryInputAdmin.value = ''; // ì…ë ¥ í•„ë“œ ë¹„ìš°ê¸°
        return;
    }

    // í´ë¼ì´ì–¸íŠ¸ì—ì„œ ë¨¼ì € ì¤‘ë³µ ê²€ì‚¬ë¥¼ í•  ìˆ˜ë„ ìˆë‹¤ì˜¹ (ì„ íƒ ì‚¬í•­)
    // í•˜ì§€ë§Œ ì„œë²„ì—ì„œë„ ì¤‘ë³µ ê²€ì‚¬ë¥¼ í•˜ë‹ˆê¹Œ ë” ì•ˆì „í•˜ë‹¤ëƒ¥!
    // if (categories.map(cat => cat.name).includes(newCategoryName)) { // categoriesê°€ ê°ì²´ ë°°ì—´ì¼ ê²½ìš°
    // if (categories.includes(newCategoryName)) { // categoriesê°€ ì´ë¦„ ë°°ì—´ì¼ ê²½ìš° (í˜„ì¬ ìš°ë¦¬ ì½”ë“œ!)
    //     alert('ì´ë¯¸ ìˆëŠ” ì¹´í…Œê³ ë¦¬ ì´ë¦„ì´ë‹¤ì˜¹! (í´ë¼ì´ì–¸íŠ¸ ì²´í¬)');
    //     return;
    // }

    try {
        console.log(`'${newCategoryName}' ì¹´í…Œê³ ë¦¬ë¥¼ ì„œë²„ì— ì¶”ê°€ ì‹œë„í•œë‹¤ì˜¹!`);
        const response = await fetch('/.netlify/functions/add-category', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({ name: newCategoryName }), // ì„œë²„ì— ë³´ë‚¼ ë°ì´í„°! {name: "ì¹´í…Œê³ ë¦¬ì´ë¦„"} í˜•íƒœ
        });

        const result = await response.json(); // ì„œë²„ì˜ ì‘ë‹µì„ JSONìœ¼ë¡œ ë³€í™˜

        if (!response.ok) {
            // ì„œë²„ì—ì„œ ì—ëŸ¬ ì‘ë‹µì´ ì˜¤ë©´ (ì˜ˆ: ì¤‘ë³µ, ì˜ëª»ëœ ìš”ì²­ ë“±)
            // result ì•ˆì— ì„œë²„ í•¨ìˆ˜ì—ì„œ ë³´ë‚¸ messageê°€ ë“¤ì–´ìˆì„ ê±°ë‹¤ëƒ¥!
            throw new Error(result.message || `ëƒì˜¹! ì¹´í…Œê³ ë¦¬ ì¶”ê°€ ì‹¤íŒ¨: ${response.status}`);
        }

        // ì„±ê³µì ìœ¼ë¡œ ì¶”ê°€ë˜ì—ˆì„ ë•Œ! (ì„œë²„ì—ì„œ ìƒíƒœ ì½”ë“œ 201ì„ ë³´ë‚´ì¤¬ì„ ë•Œ)
        console.log('ì„œë²„ì—ì„œ ì¹´í…Œê³ ë¦¬ ì¶”ê°€ ì„±ê³µ! ì‘ë‹µ:', result);
        alert(`'${result.name}' ì¹´í…Œê³ ë¦¬ê°€ ì„±ê³µì ìœ¼ë¡œ ì¶”ê°€ë˜ì—ˆë‹¤ì˜¹! ì•¼í˜¸!`);

        // ìƒˆ ì¹´í…Œê³ ë¦¬ê°€ ì¶”ê°€ëìœ¼ë‹ˆ, í´ë¼ì´ì–¸íŠ¸ì˜ categories ë°°ì—´ë„ ì—…ë°ì´íŠ¸í•˜ê³  í™”ë©´ë„ ìƒˆë¡œ ê·¸ë ¤ì•¼ í•œë‹¤ì˜¹!
        // ë°©ë²• 1: ì„œë²„ì—ì„œ ëª¨ë“  ì¹´í…Œê³ ë¦¬ë¥¼ ë‹¤ì‹œ ë¶ˆëŸ¬ì™€ì„œ categories ë°°ì—´ì„ í†µì§¸ë¡œ ê°±ì‹  (ê°€ì¥ í™•ì‹¤!)
        await refreshCategoriesFromServer(); // ì´ í•¨ìˆ˜ëŠ” ì•„ë˜ì— ìƒˆë¡œ ë§Œë“¤ ê±°ë‹¤ì˜¹!

        // ë°©ë²• 2: ì„œë²„ ì‘ë‹µ(result)ì— ìˆëŠ” ìƒˆ ì¹´í…Œê³ ë¦¬ ì •ë³´ë¥¼ í˜„ì¬ categories ë°°ì—´ì— ì¶”ê°€ (ë” ë¹ ë¥¼ ìˆ˜ ìˆì§€ë§Œ, ì •ë ¬ ë“±ì´ í•„ìš”í•  ìˆ˜ ìˆìŒ)
        // categories.push(result.name); // categoriesê°€ ì´ë¦„ ë°°ì—´ì¼ ê²½ìš°
        // categories.sort(); // ì´ë¦„ ìˆœìœ¼ë¡œ ì •ë ¬
        // populateAllCategoryDropdowns(); // í™”ë©´ ì—…ë°ì´íŠ¸

        newCategoryInputAdmin.value = ''; // ì…ë ¥ í•„ë“œ ë¹„ìš°ê¸°

    } catch (error) {
        console.error('handleAddCategory ì—ëŸ¬ ã… ã… :', error);
        alert(`ëƒì˜¹... ì¹´í…Œê³ ë¦¬ ì¶”ê°€ ì¤‘ ë¬¸ì œê°€ ìƒê²¼ë‹¤ì˜¹: ${error.message}`);
    }
}

// ëƒì˜¹! ì¹´í…Œê³ ë¦¬ ëª©ë¡ì„ ì„œë²„ì—ì„œ ë‹¤ì‹œ ê°€ì ¸ì™€ì„œ í™”ë©´ì„ ì—…ë°ì´íŠ¸í•˜ëŠ” í•¨ìˆ˜ë¥¼ ë§Œë“¤ìì˜¹!
async function refreshCategoriesFromServer() {
    try {
        console.log('ì¹´í…Œê³ ë¦¬ ëª©ë¡ ìƒˆë¡œê³ ì¹¨ ì‹œì‘ì´ë‹¤ì˜¹!');
        const response = await fetch('/.netlify/functions/get-categories');
        if (!response.ok) {
            const errorText = await response.text();
            throw new Error(`ì¹´í…Œê³ ë¦¬ ìƒˆë¡œê³ ì¹¨ ì‹¤íŒ¨: ${response.status} - ${errorText}`);
        }
        const serverCategories = await response.json();
        categories = serverCategories; // ìš”ê²ƒë„ ê·¸ëŒ€ë¡œ!
        
        console.log('ì¹´í…Œê³ ë¦¬ ëª©ë¡ ì„±ê³µì ìœ¼ë¡œ ìƒˆë¡œê³ ì¹¨ í–ˆë‹¤ì˜¹!', categories);
        populateAllCategoryDropdowns(); // ëª¨ë“  ë“œë¡­ë‹¤ìš´ ë° ê´€ë¦¬ì ëª©ë¡ ì—…ë°ì´íŠ¸!
        
        // ë§Œì•½ ê´€ë¦¬ì íŒ¨ë„ì´ ì—´ë ¤ìˆê³ , ì¹´í…Œê³ ë¦¬ ê´€ë¦¬ ëª©ë¡ì„ ë³´ì—¬ì£¼ê³  ìˆë‹¤ë©´ ê·¸ê²ƒë„ ì—…ë°ì´íŠ¸!
        if (adminPanel.style.display === 'block' && typeof renderAdminCategoryList === 'function') {
             // renderAdminCategoryList í•¨ìˆ˜ê°€ displayCategoriesë¥¼ ì¸ìë¡œ ë°›ëŠ”ë‹¤ë©´,
             // populateAllCategoryDropdowns ì•ˆì—ì„œ ì´ë¯¸ categories ë³€ìˆ˜ë¥¼ ì‚¬ìš©í•´ì„œ displayCategoriesë¥¼ ë§Œë“¤ê³  í˜¸ì¶œí•˜ê³  ìˆì„ê±°ë‹¤ëƒ¥.
             // ì—¬ê¸°ì„œëŠ” populateAllCategoryDropdowns() í˜¸ì¶œë¡œ ì¶©ë¶„í•  ìˆ˜ ìˆë‹¤ì˜¹!
             // ë§Œì•½ ì§ì ‘ í˜¸ì¶œí•´ì•¼ í•œë‹¤ë©´:
             // const uniqueCategoriesFromPhotos = photos.length > 0 ? [...new Set(photos.map(p => p.category).filter(Boolean))].sort() : [];
             // let displayCategories = [...new Set([...categories, ...uniqueCategoriesFromPhotos])].sort();
             // renderAdminCategoryList(displayCategories);
        }

    } catch (error) {
        console.error('ì¹´í…Œê³ ë¦¬ ëª©ë¡ ìƒˆë¡œê³ ì¹¨ ì¤‘ ì—ëŸ¬ ã… ã… :', error);
        alert('ì¹´í…Œê³ ë¦¬ ëª©ë¡ì„ ìƒˆë¡œ ê°€ì ¸ì˜¤ëŠ” ë° ì‹¤íŒ¨í–ˆë‹¤ì˜¹...');
    }
}
        
        // ëƒì˜¹! ì—¬ê¸°ê°€ ìˆ˜ì •ëœ renderGallery í•¨ìˆ˜ë‹¤ì˜¹!
        function renderGallery() {
            gallery.innerHTML = '';
            const filteredPhotos = currentCategoryFilter === 'ì „ì²´' ? photos : photos.filter(photo => photo.category === currentCategoryFilter);
            
            if (filteredPhotos.length === 0) {
                const emptyMessage = document.createElement('div');
                emptyMessage.style.textAlign = 'center'; 
                emptyMessage.style.padding = '40px'; 
                emptyMessage.style.width = '100%'; 
                emptyMessage.style.color = '#666';
                let messageText = `'${currentCategoryFilter}' ì¹´í…Œê³ ë¦¬ì— ì‚¬ì§„ì´ ì—†ë‹¤ì˜¹.`;
                if (currentCategoryFilter === 'ì „ì²´' && photos.length === 0) {
                    messageText = 'ì•„ì§ ì—…ë¡œë“œëœ ì‚¬ì§„ì´ í•˜ë‚˜ë„ ì—†ë‹¤ì˜¹! ê´€ë¦¬ì ëª¨ë“œì—ì„œ ìƒˆ ì‚¬ì§„ì„ ì˜¬ë ¤ë³´ë¼ëƒ¥!';
                } else if (currentCategoryFilter === 'ì „ì²´' && photos.length > 0) {
                     // ì´ ê²½ìš°ëŠ” filteredPhotos.lengthê°€ 0ì´ ë  ìˆ˜ ì—†ìœ¼ë¯€ë¡œ, ì‹¤ì œë¡œëŠ” ì—¬ê¸°ë¡œ ì˜¤ì§€ ì•ŠëŠ”ë‹¤ì˜¹.
                    messageText = 'ì‚¬ì§„ì€ ìˆì§€ë§Œ ì•Œ ìˆ˜ ì—†ëŠ” ì´ìœ ë¡œ í‘œì‹œë˜ì§€ ì•ŠëŠ”ë‹¤ì˜¹. ìƒˆë¡œê³ ì¹¨ í•´ë³´ë¼ëƒ¥!';
                }

                emptyMessage.innerHTML = `<svg width="50" height="50" viewBox="0 0 24 24" style="margin-bottom: 15px; opacity: 0.5;"><path fill="currentColor" d="M4,4H7L9,2H15L17,4H20A2,2 0 0,1 22,6V18A2,2 0 0,1 20,20H4A2,2 0 0,1 2,18V6A2,2 0 0,1 4,4M12,7A5,5 0 0,0 7,12A5,5 0 0,0 12,17A5,5 0 0,0 17,12A5,5 0 0,0 12,7M12,9A3,3 0 0,1 15,12A3,3 0 0,1 12,15A3,3 0 0,1 9,12A3,3 0 0,1 12,9Z" /></svg><p style="font-size: 16px; margin-bottom: 5px;">${messageText}</p><p style="font-size: 14px; opacity: 0.7;">ë‹¤ë¥¸ ì¹´í…Œê³ ë¦¬ë¥¼ ì„ íƒí•˜ê±°ë‚˜ ìƒˆ ì‚¬ì§„ì„ ì—…ë¡œë“œí•´ë³´ë¼ëƒ¥.</p>`;
                gallery.appendChild(emptyMessage);
                return;
            }

            filteredPhotos.forEach((photo, index) => {
                const item = document.createElement('div'); 
                item.className = 'gallery-item'; 
                item.style.opacity = '0'; 
                item.style.transform = 'translateY(20px)'; 
                item.style.transition = 'opacity 0.5s ease, transform 0.5s ease'; 
                item.style.transitionDelay = `${index * 0.05}s`;
                
                // ëƒì˜¹! ì—¬ê¸°ë„ ë°±í‹±(í…œí”Œë¦¿ ë¦¬í„°ëŸ´)ì„ ì˜¬ë°”ë¥´ê²Œ ì‚¬ìš©í•œë‹¤ì˜¹!
                // photo.imageUrlê³¼ photo.titleì´ ì‹¤ì œë¡œ ìœ íš¨í•œ ê°’ì¸ì§€ í™•ì¸í•˜ëŠ” ê²Œ ì¢‹ë‹¤ì˜¹.
                const imageUrl = photo.imageUrl || '/api/placeholder/300/250?text=ì´ë¯¸ì§€+ì—†ë‹¤ì˜¹'; // ê¸°ë³¸ ì´ë¯¸ì§€
                const title = photo.title || 'ì œëª© ì—†ë‹¤ì˜¹';

                item.innerHTML = `<img src="${imageUrl}" alt="${title}" loading="lazy"><div class="photo-title">${title}</div>`;
                item.addEventListener('click', () => openImageModal(photo.id));
                gallery.appendChild(item);
                
                // ì• ë‹ˆë©”ì´ì…˜ì„ ìœ„í•´ DOMì— ì¶”ê°€ëœ í›„ ìŠ¤íƒ€ì¼ ë³€ê²½
                setTimeout(() => { 
                    item.style.opacity = '1'; 
                    item.style.transform = 'translateY(0)'; 
                }, 10); // ì•„ì£¼ ì§§ì€ ì§€ì—°
            });
        }
        
        // ëƒì˜¹! ì—¬ê¸°ê°€ ìˆ˜ì •ëœ renderAdminGallery í•¨ìˆ˜ë‹¤ì˜¹!
        function renderAdminGallery() {
            galleryAdmin.innerHTML = '';
            // ìµœê·¼ ì—…ë¡œë“œëœ ì‚¬ì§„ì´ ìœ„ë¡œ ì˜¤ë„ë¡ photos ë°°ì—´ì„ ë³µì‚¬í•´ì„œ ë’¤ì§‘ëŠ”ë‹¤ì˜¹.
            photos.slice().reverse().forEach(photo => {
                const item = document.createElement('div'); 
                item.className = 'gallery-admin-item';
                
                const imageUrl = photo.imageUrl || '/api/placeholder/200/150?text=ì´ë¯¸ì§€X';
                const title = photo.title || 'ì œëª© ì—†ìŒ';
                const categoryText = photo.category || 'ì¹´í…Œê³ ë¦¬ ì—†ìŒ';
                const gcsFileName = photo.gcsFileName || ''; // gcsFileNameì´ ì—†ì„ ê²½ìš° ë¹ˆ ë¬¸ìì—´

                // ëƒì˜¹! ì—¬ê¸°ë„ ë°±í‹±(í…œí”Œë¦¿ ë¦¬í„°ëŸ´)ì„ ì˜¬ë°”ë¥´ê²Œ! data- ì†ì„± ê°’ë„ ë”°ì˜´í‘œë¡œ ê°ì‹¸ì¤€ë‹¤ì˜¹!
                item.innerHTML = `
                    <img src="${imageUrl}" alt="${title}" loading="lazy">
                    <div style="padding: 5px; text-align: center; font-size: 12px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">
                        ${title} 
                        <span style="display: block; color: #666; font-size: 11px;">${categoryText}</span>
                    </div>
                    <button class="delete-btn" data-id="${photo.id}" data-gcsfilename="${gcsFileName}">&times;</button>`;
                galleryAdmin.appendChild(item);
            });

            // ì‚­ì œ ë²„íŠ¼ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆëŠ” í•œ ë²ˆë§Œ ì„¤ì •í•˜ëŠ” ê²Œ ì¢‹ë‹¤ì˜¹ (renderAdminGallery í˜¸ì¶œë  ë•Œë§ˆë‹¤ ì¤‘ë³µ ë°©ì§€)
            // í•˜ì§€ë§Œ ì—¬ê¸°ì„œëŠ” ë§¤ë²ˆ ë‹¤ì‹œ ê·¸ë¦¬ë¯€ë¡œ, ìƒˆë¡œ ê·¸ë ¤ì§„ ë²„íŠ¼ë“¤ì— ëŒ€í•´ ë‹¤ì‹œ ì„¤ì •í•´ì•¼ í•œë‹¤ì˜¹.
            document.querySelectorAll('#gallery-admin .delete-btn').forEach(btn => {
                // í˜¹ì‹œ ëª¨ë¥¼ ì¤‘ë³µ ë¦¬ìŠ¤ë„ˆ ë°©ì§€ë¥¼ ìœ„í•´ ê¸°ì¡´ ë¦¬ìŠ¤ë„ˆ ì œê±° (ë” í™•ì‹¤í•œ ë°©ë²•ì€ ë‹¤ë¥¸ ê³³ì—ì„œ í•œ ë²ˆë§Œ ì„¤ì •)
                // btn.replaceWith(btn.cloneNode(true)); // ë¦¬ìŠ¤ë„ˆ ì œê±°í•˜ëŠ” í•œ ê°€ì§€ íŠ¸ë¦­
                // const newBtn = btn.cloneNode(true);
                // btn.parentNode.replaceChild(newBtn, btn);

                // ì—¬ê¸°ì„œëŠ” ê°„ë‹¨í•˜ê²Œ ë°”ë¡œ ì¶”ê°€í•œë‹¤ì˜¹.
                btn.addEventListener('click', (e) => {
                    // currentTargetì„ ì‚¬ìš©í•˜ë©´ ì´ë²¤íŠ¸ê°€ ì‹¤ì œë¡œ ë°”ì¸ë”©ëœ ë²„íŠ¼ì„ ê°€ë¦¬í‚¨ë‹¤ì˜¹.
                    const id = e.currentTarget.getAttribute('data-id');
                    const gcsFileNameValue = e.currentTarget.getAttribute('data-gcsfilename');
                    deletePhoto(id, gcsFileNameValue);
                });
            });
        }
        
        async function uploadPhoto() {
            const file = imageUploadInput.files[0];
            if (!file) { alert('ì—…ë¡œë“œí•  ì´ë¯¸ì§€ë¥¼ ì„ íƒí•´ë‹¬ë¼ì˜¹!'); return; }
            
            const title = imageTitleInput.value.trim() || `ìƒˆë¡œìš´ ëƒ¥ëƒ¥ì´ ì‚¬ì§„ ${Date.now()}`;
            const category = imageCategoryUploadDropdown.value;
            if (!category) { alert('ì‚¬ì§„ì˜ ì¹´í…Œê³ ë¦¬ë¥¼ ì„ íƒí•´ë‹¬ë¼ì˜¹!'); return; }

            const formData = new FormData();
            formData.append('imageFile', file);
            formData.append('title', title);
            formData.append('category', category);
            
            try {
                const response = await fetch('/.netlify/functions/upload-image-to-gcs', { method: 'POST', body: formData });
                if (!response.ok) {
                    const errorResult = await response.json();
                    throw new Error(errorResult.message || 'Netlify Functionì—ì„œ íŒŒì¼ ì—…ë¡œë“œ ì‹¤íŒ¨!');
                }
                await refreshPhotosFromServer(); 
                imageUploadInput.value = ''; 
                imageTitleInput.value = ''; 
                imageCategoryUploadDropdown.value = ''; // ë“œë¡­ë‹¤ìš´ë„ ì´ˆê¸°í™”
                alert('ì‚¬ì§„ì´ ì„±ê³µì ìœ¼ë¡œ ì—…ë¡œë“œ ë° ì €ì¥ë˜ì—ˆë‹¤ì˜¹!');
            } catch (error) {
                console.error('ê°¤ëŸ¬ë¦¬ ì‚¬ì§„ ì—…ë¡œë“œ ì¤‘ ì—ëŸ¬:', error);
                alert(`ëƒì˜¹... ì‚¬ì§„ ì—…ë¡œë“œ ì‹¤íŒ¨: ${error.message}`);
            }
        }
        
        async function refreshPhotosFromServer() {
            try {
                const photosResponse = await fetch('/.netlify/functions/get-photos');
                if (photosResponse.ok) {
                    photos = await photosResponse.json();
                    // ë°ì´í„° ë¡œë“œ í›„ UI ì—…ë°ì´íŠ¸ ìˆœì„œ ì¤‘ìš”!
                    populateAllCategoryDropdowns(); // ì¹´í…Œê³ ë¦¬ ë¨¼ì € ì—…ë°ì´íŠ¸
                    renderGallery();                 // ë©”ì¸ ê°¤ëŸ¬ë¦¬ ì—…ë°ì´íŠ¸
                    if (localStorage.getItem('isLoggedIn') === 'true') { // ë¡œê·¸ì¸ ìƒíƒœì¼ ë•Œë§Œ ì–´ë“œë¯¼ ê°¤ëŸ¬ë¦¬ ì—…ë°ì´íŠ¸
                        renderAdminGallery();
                    }
                } else {
                    console.error('refreshPhotosFromServer: ì‚¬ì§„ ëª©ë¡ ê°€ì ¸ì˜¤ê¸° ì‹¤íŒ¨');
                    photos = []; // ì‹¤íŒ¨ ì‹œ ì‚¬ì§„ ëª©ë¡ ë¹„ìš°ê¸°
                    populateAllCategoryDropdowns(); // ì¹´í…Œê³ ë¦¬ ë“œë¡­ë‹¤ìš´ì€ ë¹ˆ ìƒíƒœë¡œë¼ë„ ì—…ë°ì´íŠ¸
                    renderGallery();                 // ê°¤ëŸ¬ë¦¬ë„ ë¹ˆ ìƒíƒœë¡œ ì—…ë°ì´íŠ¸
                     if (localStorage.getItem('isLoggedIn') === 'true') {
                        renderAdminGallery();
                    }
                }
            } catch (e) {
                console.error('refreshPhotosFromServer: ì‚¬ì§„ ëª©ë¡ ê°€ì ¸ì˜¤ëŠ” ì¤‘ ë„¤íŠ¸ì›Œí¬ ì—ëŸ¬', e);
                photos = []; // ì—ëŸ¬ ì‹œ ì‚¬ì§„ ëª©ë¡ ë¹„ìš°ê¸°
                populateAllCategoryDropdowns();
                renderGallery();
                 if (localStorage.getItem('isLoggedIn') === 'true') {
                    renderAdminGallery();
                }
            }
        }

        // deletePhoto í•¨ìˆ˜ì— setTimeout ì¶”ê°€ (ì´ì „ì— ì œì•ˆí–ˆë˜ ë‚´ìš©)
        async function deletePhoto(photoId, gcsFileName) {
            if (!photoId) { alert('ì‚­ì œí•  ì‚¬ì§„ì˜ IDê°€ ì—†ë‹¤ì˜¹!'); return; }
            if (confirm('ì •ë§ë¡œ ì´ ì‚¬ì§„ì„ ì„œë²„ì—ì„œ ì‚­ì œí• ê±°ëƒ¥? ë˜ëŒë¦´ ìˆ˜ ì—†ë‹¤ì˜¹!')) {
                try {
                    const response = await fetch('/.netlify/functions/delete-photo', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ photoId: photoId, gcsFileName: gcsFileName })
                    });
                    if (!response.ok) {
                        const errorResult = await response.json();
                        throw new Error(errorResult.message || 'Netlify Functionì—ì„œ ì‚¬ì§„ ì‚­ì œ ì‹¤íŒ¨!');
                    }
                    
                    alert('ì‚¬ì§„ì´ ì„œë²„ì—ì„œ ì‚­ì œë˜ì—ˆë‹¤ì˜¹!'); // ì„±ê³µ ì•Œë¦¼ ë¨¼ì €!

                    // ì‚´ì§ ê¸°ë‹¤ë ¸ë‹¤ê°€ ëª©ë¡ ìƒˆë¡œê³ ì¹¨ (ì„œë²„ ë°ì´í„° ë°˜ì˜ ì‹œê°„ ê³ ë ¤)
                    setTimeout(async () => {
                        await refreshPhotosFromServer();
                        console.log('ì‚­ì œ í›„, 0.5ì´ˆ ë’¤ì— ì‚¬ì§„ ëª©ë¡ ìƒˆë¡œê³ ì¹¨ ì™„ë£Œë‹¤ì˜¹!');
                    }, 500); // 0.5ì´ˆ ì§€ì—° (í•„ìš”ì— ë”°ë¼ ì¡°ì ˆ)

                } catch (error) {
                    console.error('ì‚¬ì§„ ì‚­ì œ ì¤‘ ì—ëŸ¬:', error);
                    alert(`ëƒì˜¹... ì‚¬ì§„ ì‚­ì œ ì‹¤íŒ¨: ${error.message}`);
                }
            }
        }
        
        function openImageModal(photoId) {
            // í˜„ì¬ í•„í„°ë§ëœ ì‚¬ì§„ ëª©ë¡ ë˜ëŠ” ì „ì²´ ì‚¬ì§„ ëª©ë¡ì—ì„œ í•´ë‹¹ photoIdë¥¼ ì°¾ëŠ”ë‹¤ì˜¹.
            let photosToSearch = photos; // ê¸°ë³¸ê°’ì€ ì „ì²´ ì‚¬ì§„
            if (currentCategoryFilter !== 'ì „ì²´') {
                photosToSearch = photos.filter(photo => photo.category === currentCategoryFilter);
                // ë§Œì•½ í•„í„°ëœ ëª©ë¡ì— ì—†ë‹¤ë©´ ì „ì²´ ëª©ë¡ì—ì„œë„ ì°¾ì•„ë³¸ë‹¤ì˜¹ (í˜¹ì‹œ ëª¨ë¥¼ ìƒí™© ëŒ€ë¹„)
                if (!photosToSearch.find(p => p.id === photoId)) {
                    photosToSearch = photos;
                }
            }
            
            currentModalPhotoIndex = photosToSearch.findIndex(photo => photo.id === photoId);

            if (currentModalPhotoIndex === -1) { 
                console.error(`ëª¨ë‹¬ì—ì„œ ì‚¬ì§„ ID '${photoId}'ë¥¼ ì°¾ì„ ìˆ˜ ì—†ë‹¤ì˜¹!`);
                // í˜¹ì‹œ ëª¨ë¥´ë‹ˆ ì „ì²´ ì‚¬ì§„ ëª©ë¡ì—ì„œ ë‹¤ì‹œ í•œë²ˆ ì‹œë„
                currentModalPhotoIndex = photos.findIndex(photo => photo.id === photoId);
                if (currentModalPhotoIndex === -1) return; // ê·¸ë˜ë„ ì—†ìœ¼ë©´ ê·¸ëƒ¥ ì¢…ë£Œ
                photosToSearch = photos; // ê²€ìƒ‰ ëŒ€ìƒì„ ì „ì²´ ì‚¬ì§„ìœ¼ë¡œ ë³€ê²½
            }
            
            displayCurrentPhotoInModal(photosToSearch); // ê²€ìƒ‰í•œ ë°°ì—´ì„ ì „ë‹¬
            imageModal.style.display = 'flex';
        }

        // ëƒì˜¹! ì—¬ê¸°ê°€ ìˆ˜ì •ëœ displayCurrentPhotoInModal í•¨ìˆ˜ë‹¤ì˜¹!
        function displayCurrentPhotoInModal(photoArrayToDisplay) { // ë§¤ê°œë³€ìˆ˜ ì´ë¦„ ë³€ê²½
            if (currentModalPhotoIndex >= 0 && currentModalPhotoIndex < photoArrayToDisplay.length) {
                const photo = photoArrayToDisplay[currentModalPhotoIndex];
                if (!photo) { // í˜¹ì‹œ photo ê°ì²´ê°€ undefinedì¼ ê²½ìš° ëŒ€ë¹„
                    console.error("í‘œì‹œí•  ì‚¬ì§„ ê°ì²´ê°€ ì—†ë‹¤ì˜¹!", currentModalPhotoIndex, photoArrayToDisplay);
                    return;
                }
                
                modalImage.src = photo.imageUrl || '/api/placeholder/800/600?text=ì´ë¯¸ì§€+ì—†ë‹¤ì˜¹';
                
                // innerHTMLì„ ì‚¬ìš©í•  ë•ŒëŠ” XSS ê³µê²©ì— ì£¼ì˜í•´ì•¼ í•˜ì§€ë§Œ, ì—¬ê¸°ì„œëŠ” ì§ì ‘ ì…ë ¥í•œ ë°ì´í„°ë¥¼ í‘œì‹œí•˜ë¯€ë¡œ ê´œì°®ë‹¤ì˜¹.
                // í•˜ì§€ë§Œ ê°€ëŠ¥í•˜ë‹¤ë©´ textContentë¥¼ ë¶€ë¶„ì ìœ¼ë¡œ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ë” ì•ˆì „í•  ìˆ˜ ìˆë‹¤ëƒ¥.
                const title = photo.title || 'ì œëª© ì—†ìŒ';
                const category = photo.category || 'ì¹´í…Œê³ ë¦¬ ì—†ìŒ';
                
                // ëƒì˜¹! ì—¬ê¸°ë„ ë°±í‹±(í…œí”Œë¦¿ ë¦¬í„°ëŸ´)ì„ ì˜¬ë°”ë¥´ê²Œ! HTML ë¬¸ìì—´ë¡œ êµ¬ì„±í•œë‹¤ì˜¹.
                modalTitleElement.innerHTML = `
                    ${title}<br>
                    <span style="font-size: 14px; opacity: 0.8;">@UU_CATS</span>
                    <span style="display: inline-block; margin-left: 10px; font-size: 12px; background-color: rgba(255,255,255,0.3); padding: 3px 10px; border-radius: 12px; backdrop-filter: blur(5px);">
                        ${category}
                    </span>`;
            } else {
                // ëª¨ë‹¬ ë„¤ë¹„ê²Œì´ì…˜ ë²„íŠ¼ ìˆ¨ê¸°ê¸° ë˜ëŠ” ë¹„í™œì„±í™” ë¡œì§ ì¶”ê°€ ê°€ëŠ¥
                prevBtn.style.display = 'none';
                nextBtn.style.display = 'none';
            }
            // ì‚¬ì§„ì´ ìˆìœ¼ë©´ ë„¤ë¹„ê²Œì´ì…˜ ë²„íŠ¼ ë‹¤ì‹œ ë³´ì´ê²Œ
             if (photoArrayToDisplay.length > 1) {
                prevBtn.style.display = 'block';
                nextBtn.style.display = 'block';
            } else {
                prevBtn.style.display = 'none';
                nextBtn.style.display = 'none';
            }
        }

        function showPreviousPhotoInModal() {
            let photosToDisplay = photos;
            if (currentCategoryFilter !== 'ì „ì²´') {
                photosToDisplay = photos.filter(photo => photo.category === currentCategoryFilter);
                 if (photosToDisplay.length === 0 && photos.length > 0) photosToDisplay = photos; // í•„í„°ëœ ê²°ê³¼ ì—†ìœ¼ë©´ ì „ì²´ì—ì„œ
            }
            if (photosToDisplay.length === 0) return; // ì‚¬ì§„ ì—†ìœ¼ë©´ ì•„ë¬´ê²ƒë„ ì•ˆí•¨

            currentModalPhotoIndex = (currentModalPhotoIndex - 1 + photosToDisplay.length) % photosToDisplay.length;
            displayCurrentPhotoInModal(photosToDisplay);
        }

        function showNextPhotoInModal() {
            let photosToDisplay = photos;
             if (currentCategoryFilter !== 'ì „ì²´') {
                photosToDisplay = photos.filter(photo => photo.category === currentCategoryFilter);
                if (photosToDisplay.length === 0 && photos.length > 0) photosToDisplay = photos; // í•„í„°ëœ ê²°ê³¼ ì—†ìœ¼ë©´ ì „ì²´ì—ì„œ
            }
            if (photosToDisplay.length === 0) return; // ì‚¬ì§„ ì—†ìœ¼ë©´ ì•„ë¬´ê²ƒë„ ì•ˆí•¨

            currentModalPhotoIndex = (currentModalPhotoIndex + 1) % photosToDisplay.length;
            displayCurrentPhotoInModal(photosToDisplay);
        }
        
        async function login() { 
            const usernameInput = document.getElementById('username'); 
            const passwordInput = document.getElementById('password'); 
            const username = usernameInput.value; 
            const password = passwordInput.value;

            if (!username || !password) {
                alert('ì•„ì´ë””ì™€ ë¹„ë°€ë²ˆí˜¸ë¥¼ ëª¨ë‘ ì…ë ¥í•´ë‹¬ë¼ì˜¹!');
                return;
            }

            try {
                const response = await fetch('/.netlify/functions/login-police', { 
                    method: 'POST', 
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ username: username, password: password }) 
                });
                const result = await response.json(); 
                if (response.ok && result.success) { 
                    localStorage.setItem('isLoggedIn', 'true');
                    loginModal.style.display = 'none'; 
                    usernameInput.value = ''; // ì…ë ¥ í•„ë“œ ì´ˆê¸°í™”
                    passwordInput.value = ''; // ì…ë ¥ í•„ë“œ ì´ˆê¸°í™”
                    checkLogin(); // ê´€ë¦¬ì UI ì—…ë°ì´íŠ¸
                    alert(result.message || 'ë¡œê·¸ì¸ ì„±ê³µì´ë‹¤ì˜¹!');
                } else {
                    alert(result.message || 'ì•„ì´ë”” ë˜ëŠ” ë¹„ë°€ë²ˆí˜¸ê°€ í‹€ë ¸ë‹¤ì˜¹!');
                    passwordInput.value = ''; // ë¹„ë°€ë²ˆí˜¸ í•„ë“œë§Œ ì´ˆê¸°í™”
                }
            } catch (error) { 
                console.error('ë¡œê·¸ì¸ ì—ëŸ¬:', error); 
                alert('ëƒì˜¹... ë¡œê·¸ì¸ ì¤‘ ì„œë²„ì— ë¬¸ì œê°€ ìƒê²¼ë‹¤ì˜¹!'); 
            }
        }

        function logout() {
            if (confirm('ì •ë§ë¡œ ë¡œê·¸ì•„ì›ƒ í• ê±°ëƒ¥?')) {
                localStorage.removeItem('isLoggedIn');
                adminPanel.style.display = 'none';
                loginButton.textContent = 'ê´€ë¦¬ì ë¡œê·¸ì¸'; // ë²„íŠ¼ í…ìŠ¤íŠ¸ ë³€ê²½
                alert('ë¡œê·¸ì•„ì›ƒ ë˜ì—ˆë‹¤ì˜¹!');
            }
        }

        function checkLogin() {
            const isLoggedIn = localStorage.getItem('isLoggedIn') === 'true';
            if (isLoggedIn) {
                adminPanel.style.display = 'block';
                loginButton.textContent = 'ê´€ë¦¬ì íŒ¨ë„ ë³´ê¸°'; // ë¡œê·¸ì¸ ì‹œ ë²„íŠ¼ í…ìŠ¤íŠ¸
                // ê´€ë¦¬ì ë¡œê·¸ì¸ ì‹œ í•„ìš”í•œ ë°ì´í„° ë¡œë”© ë° UI ë Œë”ë§
                renderAdminGallery(); 
                populateAllCategoryDropdowns(); // ì¹´í…Œê³ ë¦¬ ëª©ë¡ (ê´€ë¦¬ììš© í¬í•¨) ë‹¤ì‹œ ê·¸ë¦¬ê¸°
                updateHeroSection(); // íˆì–´ë¡œ ì„¹ì…˜ ì •ë³´ (ê´€ë¦¬ì ì…ë ¥ í•„ë“œ ë“±) ì—…ë°ì´íŠ¸
            } else {
                adminPanel.style.display = 'none';
                loginButton.textContent = 'ê´€ë¦¬ì ë¡œê·¸ì¸'; // ë¡œê·¸ì•„ì›ƒ ì‹œ ë²„íŠ¼ í…ìŠ¤íŠ¸
            }
        }
        
        function setupEventListeners() {
            loginButton.addEventListener('click', () => {
                const isLoggedIn = localStorage.getItem('isLoggedIn') === 'true';
                if (isLoggedIn) { // ì´ë¯¸ ë¡œê·¸ì¸ ìƒíƒœë¼ë©´
                    if (adminPanel.style.display === 'block') { // ê´€ë¦¬ì íŒ¨ë„ì´ ì—´ë ¤ìˆìœ¼ë©´
                        adminPanel.style.display = 'none';      // ë‹«ê³ 
                        loginButton.textContent = 'ê´€ë¦¬ì íŒ¨ë„ ì—´ê¸°'; // ë²„íŠ¼ í…ìŠ¤íŠ¸ ë³€ê²½
                    } else { // ê´€ë¦¬ì íŒ¨ë„ì´ ë‹«í˜€ìˆìœ¼ë©´
                        adminPanel.style.display = 'block';     // ì—´ê³ 
                        loginButton.textContent = 'ê´€ë¦¬ì íŒ¨ë„ ë‹«ê¸°'; // ë²„íŠ¼ í…ìŠ¤íŠ¸ ë³€ê²½
                        checkLogin(); // íŒ¨ë„ ë‚´ìš© ìµœì‹ í™” (ì¤‘ìš”!)
                        // ë¶€ë“œëŸ½ê²Œ ìŠ¤í¬ë¡¤ (ì˜µì…˜)
                        window.scrollTo({ top: adminPanel.offsetTop - 80, behavior: 'smooth' }); 
                    }
                } else { // ë¡œê·¸ì•„ì›ƒ ìƒíƒœë¼ë©´
                    loginModal.style.display = 'flex'; // ë¡œê·¸ì¸ ëª¨ë‹¬ ë„ìš°ê¸°
                }
            });

            loginSubmit.addEventListener('click', login);
            logoutBtn.addEventListener('click', logout);
            uploadBtn.addEventListener('click', uploadPhoto);
            closeModal.addEventListener('click', () => imageModal.style.display = 'none');
            prevBtn.addEventListener('click', showPreviousPhotoInModal);
            nextBtn.addEventListener('click', showNextPhotoInModal);
            
            categoryDropdown.addEventListener('change', (e) => { 
                currentCategoryFilter = e.target.value; 
                renderGallery(); 
            });

            heroImageUploadBtnAdmin.addEventListener('click', handleHeroImageUpload);
            heroImageDeleteBtnAdmin.addEventListener('click', deleteHeroImage);
            heroTextSaveBtnAdmin.addEventListener('click', saveHeroText);
            heroTextDeleteBtnAdmin.addEventListener('click', deleteHeroText);
            addCategoryBtnAdmin.addEventListener('click', handleAddCategory);
            
            // í‚¤ë³´ë“œ ì´ë²¤íŠ¸ (ëª¨ë‹¬ ë‚´ì—ì„œ)
            document.addEventListener('keydown', (e) => {
                 if (imageModal.style.display === 'flex') { // ëª¨ë‹¬ì´ ì—´ë ¤ìˆì„ ë•Œë§Œ ì‘ë™
                    if (e.key === 'ArrowLeft') showPreviousPhotoInModal();
                    else if (e.key === 'ArrowRight') showNextPhotoInModal();
                    else if (e.key === 'Escape') imageModal.style.display = 'none';
                }
            });

            // ëª¨ë‹¬ ë°”ê¹¥ ì˜ì—­ í´ë¦­ ì‹œ ë‹«ê¸°
            window.addEventListener('click', (e) => {
                if (e.target === imageModal) imageModal.style.display = 'none';
                if (e.target === loginModal) loginModal.style.display = 'none';
            });

            // íŠ¸ìœ„í„° ë§í¬ (ìƒˆ ì°½ì—ì„œ ì—´ê¸°)
            twitterLink.addEventListener('click', (e) => { 
                e.preventDefault(); // ê¸°ë³¸ ë™ì‘ ë§‰ê¸°
                window.open('https://x.com/UU_CATS', '_blank'); 
            });
        }
        
        // í˜ì´ì§€ ë¡œë“œ ì™„ë£Œ í›„ init í•¨ìˆ˜ ì‹¤í–‰
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>